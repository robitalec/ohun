p + geom_label2(aes(subset=!isTip, label=node), size=4)
p2  + geom_cladelabel(46, "clade1", offset=25, barsize=2, angle=90)
p2  + geom_cladelabel(46, "clade1", barsize=2, angle=90)
p2  + geom_cladelabel(46, "clade1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=2)
p2  + geom_cladelabel(46, "clade1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5)
# check node number
p + geom_label2(aes(subset=!isTip, label=node), size=4)
p2  + geom_cladelabel(46, "clade 1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5) +
geom_cladelabel(32, "clade 2", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5)
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("ggtree")
library(ggplot2)
library(ggstance)
library(ggtree)
library(reshape2)
set.seed(123)
tree <- rtree(30)
p <- ggtree(tree, branch.length = "none") +
geom_tiplab(size=0) + theme(legend.position='none')
v1 <- runif(30, 0,1)
v2 <- runif(30, 0,1)
v3 <- runif(30, 0,1)
df <- data.frame(tree$tip.label, v1, v2, v3)
p2 <- facet_plot(p + xlim_tree(8), panel = 'v1', data = df, geom = geom_barh,
mapping = aes(x = v1), fill = "red",
width = 0.8, stat='identity') + xlim_tree(9) + theme_classic()
p2 <- facet_plot(p2 + xlim_tree(8), panel = 'v2', data = df, geom = geom_barh,
mapping = aes(x = v2), fill = "blue",
width = 0.8, stat='identity') + theme_classic()
p2 <- facet_plot(p2 + xlim_tree(8), panel = 'v3', data = df, geom = geom_barh,
mapping = aes(x = v3), fill = "green",
width = 0.8, stat='identity') + theme_classic()
# check node number
p + geom_label2(aes(subset=!isTip, label=node), size=4)
p2  + geom_cladelabel(46, "clade 1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5) +
geom_cladelabel(32, "clade 2", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5)
p2  + geom_cladelabel(46, "clade 1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5) +
geom_cladelabel(32, "clade 2", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5)
library(grid)
library(gtable)
gt = ggplot_gtable(ggplot_build(p2))
gtable_show_layout(gt) # will show you the layout - very handy function
gt # see plot layout in table format
# gt # see plot layout in table format
gt$layout$l[grep('panel-2', gt$layout$name)] # you want to find the column specific to panel-2
# gt # see plot layout in table format
gt$layout$l[grep('v2', gt$layout$name)] # you want to find the column specific to panel-2
gt$layout$name
# gt # see plot layout in table format
gt$layout$l[grep('panel-1-2', gt$layout$name)] # you want to find the column specific to panel-2
gt$widths[7] = 0.5*gt$widths[7] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
# gt # see plot layout in table format
gt$layout$l[grep('panel-1', gt$layout$name)] # you want to find the column specific to panel-2
gt$widths[7] = 0.5*gt$widths[7] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
gt$layout$name
gt = ggplot_gtable(ggplot_build(p2))
gtable_show_layout(gt) # will show you the layout - very handy function
# gt # see plot layout in table format
wp <- gt$layout$l[grep('panel-1', gt$layout$name)] # you want to find the column specific to panel-2
gt$widths[wp] = 0.5*gt$widths[wp] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
wp
gt = ggplot_gtable(ggplot_build(p2))
gtable_show_layout(gt) # will show you the layout - very handy function
# gt # see plot layout in table format
wp <- gt$layout$l[grep('panel-1', gt$layout$name)] # you want to find the column specific to panel-2
gt$widths[wp] = 0.2*gt$widths[wp] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
gt = ggplot_gtable(ggplot_build(p2))
gtable_show_layout(gt) # will show you the layout - very handy function
# gt # see plot layout in table format
wp <- gt$layout$l[grep('panel-1-1', gt$layout$name)] # you want to find the column specific to panel-2
gt$widths[wp] = 0.5*gt$widths[wp] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
gt$widths[wp] = 1.5*gt$widths[wp] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
gt = ggplot_gtable(ggplot_build(p2))
gtable_show_layout(gt) # will show you the layout - very handy function
# gt # see plot layout in table format
wp <- gt$layout$l[grep('panel-1-1', gt$layout$name)] # you want to find the column specific to panel-2
gt$widths[wp] = 1.5*gt$widths[wp] # in this case it was colmun 7 - reduce the width by a half
grid.draw(gt)
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("ggtree")
library(ggplot2)
library(ggstance)
library(ggtree)
library(reshape2)
set.seed(123)
tree <- rtree(30)
p <- ggtree(tree, branch.length = "none") +
geom_tiplab(size=0) + theme(legend.position='none')
v1 <- runif(30, 0,1)
v2 <- runif(30, 0,1)
v3 <- runif(30, 0,1)
df <- data.frame(tree$tip.label, v1, v2, v3)
p2 <- facet_plot(p + xlim_tree(8), panel = 'v1', data = df, geom = geom_barh,
mapping = aes(x = v1), fill = "red",
width = 0.8, stat='identity') + xlim_tree(9) + theme_classic()
p2 <- facet_plot(p2 + xlim_tree(8), panel = 'v2', data = df, geom = geom_barh,
mapping = aes(x = v2), fill = "blue",
width = 0.8, stat='identity') + theme_classic()
p2 <- facet_plot(p2 + xlim_tree(8), panel = 'v3', data = df, geom = geom_barh,
mapping = aes(x = v3), fill = "green",
width = 0.8, stat='identity') + theme_classic()
# check node number
p + geom_label2(aes(subset=!isTip, label=node), size=4)
p2  + geom_cladelabel(46, "clade 1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5) +
geom_cladelabel(32, "clade 2", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5)
library(grid)
library(gtable)
# make phylogeny wider
gt = ggplot_gtable(ggplot_build(p2))
# gtable_show_layout(gt) # will show you the layout - very handy function
wp <- gt$layout$l[grep('panel-1-1', gt$layout$name)]
gt$widths[wp] = 2.5*gt$widths[wp]
grid.draw(gt)
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("ggtree")
library(ggplot2)
library(ggstance)
library(ggtree)
library(reshape2)
set.seed(123)
tree <- rtree(30)
p <- ggtree(tree, branch.length = "none") +
geom_tiplab(size=0) + theme(legend.position='none')
v1 <- runif(30, 0,1)
v2 <- runif(30, 0,1)
v3 <- runif(30, 0,1)
df <- data.frame(tree$tip.label, v1, v2, v3)
p2 <- facet_plot(p + xlim_tree(8), panel = 'v1', data = df, geom = geom_barh,
mapping = aes(x = v1), fill = "red",
width = 0.8, stat='identity') + xlim_tree(9) + theme_classic()
p2 <- facet_plot(p2 + xlim_tree(8), panel = 'v2', data = df, geom = geom_barh,
mapping = aes(x = v2), fill = "blue",
width = 0.8, stat='identity') + theme_classic()
p2 <- facet_plot(p2 + xlim_tree(8), panel = 'v3', data = df, geom = geom_barh,
mapping = aes(x = v3), fill = "green",
width = 0.8, stat='identity') + theme_classic()
# check node number
p + geom_label2(aes(subset=!isTip, label=node), size=4)
p2 <- p2  + geom_cladelabel(46, "clade 1", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5) +
geom_cladelabel(32, "clade 2", barsize=1, angle=90, offset.text=1.5, hjust=0.5, fontsize=5)
# make phylogeny wider
library(grid)
library(gtable)
gt = ggplot_gtable(ggplot_build(p2))
# gtable_show_layout(gt) # will show you the layout - very handy function
wp <- gt$layout$l[grep('panel-1-1', gt$layout$name)]
gt$widths[wp] = 2.5*gt$widths[wp]
grid.draw(gt)
iris
str(iris)
str(droplevels(iris))
iris2 <- iris[1:50, ]
iris2
str(iris2)
str(droplevels(iris2))
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.6, to = 0.8, output = "Wave")
spectro(t2)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
def.off()
dec.off()
dev.off()
env(t2)
et2 <- abs(t2@left)
plot(et2)
plot(et2, type = "l")
env(t2, envt = "hil")
env(t2, envt = "abs")
env(t2, envt = "abs")
env(t2, envt = "hil")
env(t2, envt = "hil", ssmooth = 100)
env(t2, envt = "abs", ssmooth = 100)
t3 <- t2 * 0.5
plot(et2, type = "l")
lines(abs(t3@left))
par(new = TRUE)
env(t3, envt = "abs", ssmooth = 100)
env(t2, envt = "abs", ssmooth = 100)
env(t2, envt = "abs", ssmooth = 100)
t3 <- t2 * 0.5
env(t3, envt = "abs", ssmooth = 100)
par(new = TRUE)
env(t2, envt = "abs", ssmooth = 100)
t3 <- t2 * 0.5
par(new = TRUE)
env(t3, envt = "abs", ssmooth = 100)
range(t2@left)
range(t2@t3)
range(t3@left)
env(t2, envt = "abs", ssmooth = 100, norm = FALSE)
t3 <- t2 * 0.5
range(t3@left)
par(new = TRUE)
env(t3, envt = "abs", ssmooth = 100, norm = FALSE)
env(t2, envt = "abs", ssmooth = 100, norm = FALSE)
t3 <- t2 * 0.5
par(new = TRUE)
env(t3, envt = "abs", ssmooth = 100, norm = FALSE)
env(t3, envt = "abs", ssmooth = 100, norm = FALSE, col = "red")
env(t3, envt = "abs", ssmooth = 100, norm = FALSE, colwave = "red")
env(t2, envt = "abs", ssmooth = 100, norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
par(new = TRUE)
env(t3, envt = "abs", ssmooth = 100, norm = FALSE, colwave = "red")
t3
locator(2)
env(t2, envt = "abs", ssmooth = 100, norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
par(new = TRUE)
env(t3, envt = "abs", ssmooth = 100, norm = FALSE, colwave = "red")
env(t2, envt = "hil", ssmooth = 100, norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
par(new = TRUE)
env(t3, envt = "hil", ssmooth = 100, norm = FALSE, colwave = "red")
env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
par(new = TRUE)
env(t3, envt = "hil", norm = FALSE, colwave = "red")
env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.25
par(new = TRUE)
env(t3, envt = "hil", norm = FALSE, colwave = "red")
range(t3@left)
range(t2@left)
range(t3@left)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.25
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
range(et2[, 2])
et2
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
plot(et3[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et2)
sum(et3)
et2
length(et2)
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
et2[6000:8820] <- mean(et2)
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et3)
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
et3[6000:8820] <- mean(et3)
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et3)
et3[6000:8820] <- sample(et3[, 1], size = 8820 - 6000)
et3[6000:8820] <- sample(et3[, 1], size = 8821 - 6000)
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
et3[6000:8820] <- sample(et3[, 1], size = 8821 - 6000)
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et3)
et3[5000:6000] <- sample(et3[, 1], size = 1001)
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
et3[5000:6000] <- sample(et3[, 1], size = 1001)
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et3)
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
et3[5000:6000] <- sample(et3[, 1], size = 1001) / 3
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et3)
cor(et2, et3)
cor(et2, et2)
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 0.5
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
cor(et2, et3)
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray")
t3 <- t2 * 1
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red")
cor(et2, et3)
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2 * 0.25
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2
cor(et2, et3)
t3 <- t3 * 0.25
cor(et2, et3)
range(t2@left)
range(t3@left)
par(new = TRUE)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
et3[5000:6000] <- sample(et3[, 1], size = 1001) / 3
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2
cor(et2, et3)
t3 <- t3 * 0.25
cor(et2, et3)
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2
cor(et2, et3)
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2
cor(et2, et3)
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
cor(et2, et3)
t3 <- t3 * 0.25
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
cor(et2, et3)
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
lines(et3[, 1], type = "l", col = "green")
library(seewave)
data(tico)
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
# spectro(t2)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
cor(et2, et3)
t3 <- t3 * 0.25
et4 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
cor(et2, et4)
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "green")
lines(et4[, 1], type = "l", col = "red")
plot(et2[,1], et[,3])
plot(et2[,1], et3[, 1])
plot(et2[,1], et4[, 1])
plot(et2[,1], et3[, 1])
plot(et2[,1], et4[, 1])
et3[5000:6000] <- sample(et3[, 1], size = 1001) / 3
et2 <- et2 / sum(et2)
et3 <- et3 / sum(et3)
range(et2[, 1])
range(et3[, 1])
plot(et2[, 1], type = "l")
lines(et3[, 1], type = "l", col = "red")
sum(et3)
plot(et2[,1], et3[, 1])
rms(et2)
rms(et3)
rms(et4)
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = FALSE)
t3 <- t2
et3 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
cor(et2, et3)
rms(et2)
t3 <- t3 * 0.25
et4 <- env(t3, envt = "hil", norm = FALSE, colwave = "red", plot = FALSE)
rms(et4)
rms(et2)/  rms(et4)
cor(et2, et3)
cor(et2, et4)
plot(et2[, 1], type = "l")
plot(et2[,1], et3[, 1])
plot(et2[,1], et4[, 1])
plot(et2[,1], et3[, 1])
plot(et2[,1], et4[, 1])
spectro(tico)
t2 <-  cutw(tico, from = 0.5, to = 0.9, output = "Wave")
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = TRUE)
dev.off()
et2 <- env(t2, envt = "hil", norm = FALSE, colwave = "gray", plot = TRUE)
meanspec(t2)
ms <- meanspec(t2)
rms(ms[,1])
ms[,1]/ sum(ms[,1])
